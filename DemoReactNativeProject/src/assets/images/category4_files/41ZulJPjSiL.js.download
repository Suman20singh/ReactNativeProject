'use strict';mix_d("VSEDistributionCards__vse-ingress-popover-card:vse-ingress-popover-card__caiSOXwK","require exports tslib @p/A @c/scoped-dom @p/a-modal @c/logger @c/metrics @c/aui-untrusted-ajax @c/navigation @c/aui-carousel @c/browser-window".split(" "),function(Qa,qa,z,Ra,Sa,Ta,Ua,Z,Va,Wa,Xa,Ya){function D(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function Za(a){if(a&&a.__esModule)return a;var b=Object.create(null);a&&Object.keys(a).forEach(function(e){if("default"!==e){var g=
Object.getOwnPropertyDescriptor(a,e);Object.defineProperty(b,e,g.get?g:{enumerable:!0,get:function(){return a[e]}})}});b["default"]=a;return b}var c=D(Ra),Q=D(Sa),$a=D(Ta),ab=D(Ua),bb=D(Va),ra=D(Wa),cb=D(Xa),L=D(Ya),sa,A=function(a){var b=sa;Object.keys(a).length!==b.requiredNumOfFields&&Z.count("invalidNumOfFields-"+b.producerId,1);a=JSON.stringify(a).replace(/\\\\/g,"");Z.event(JSON.parse(a),b.producerId,b.schemaId,{ssd:!1})},db=function(a){return function(b){return c["default"].$.extend({eventSource:a.eventSource,
placementContext:a.placementContext,clientId:a.clientId,timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:"0",videoAsin:"",videoAsinList:a.videoAsinList||"",rankingStrategy:a.rankingStrategy||"",creativeId:a.creativeId,stringPayload:a.stringPayload||""},b)}},eb=function(){return function(a,b,e){var g=this;this.map=[];this.onHorizontalIntersectionObserved=function(h){h.forEach(function(k){var l=g.childElems.indexOf(k.target);g.map=k.isIntersecting?z.__spread(g.map,[l]):g.map.filter(function(f){return f!==
l});g.intersectingTargetsIndexes=g.map.sort(function(f,n){return f-n})})};this.onViewportIntersectionObserved=function(h){h[0].isIntersecting&&g.callback()};this.getElementsWhichAreInViewPort=function(){return g.intersectingTargetsIndexes};void 0===a&&(a=null);this.callback=e;this.parentEle=a;this.childElems=Array.from(document.querySelectorAll(b));this.optionsForHorizontalIntersection={root:this.parentEle,rootMargin:"0px",threshold:.85};this.optionsForViewportIntersection={root:null,rootMargin:"-50% 0% -50% 0%",
threshold:0};this.horizontalIntersectionObserver=new IntersectionObserver(this.onHorizontalIntersectionObserved,this.optionsForHorizontalIntersection);this.viewportIntersectionObserver=new IntersectionObserver(this.onViewportIntersectionObserved,this.optionsForViewportIntersection);this.childElems.forEach(function(h){g.horizontalIntersectionObserver.observe(h)});this.viewportIntersectionObserver.observe(a)}}(),d={pageType:"",clientPrefix:"",deviceType:"",placement:"",metricsPlacement:"",cardId:"",
creativeId:"",requester:"",buildCsmPayload:function(a){},enableMultipleImpressions:!1,clientName:""},q=function(a,b){void 0===b&&(b=1);try{Z.count("vse:csm:cards:"+d.clientPrefix+":"+a,b)}catch(e){v("failed to post CSM metric","ERROR")}},E=function(a,b){void 0===b&&(b=1);q(a+":"+d.deviceType,b)},v=function(a,b){ab["default"].log("VSEWidgetCards: "+a+". Client prefix: "+d.clientPrefix+", Page type: "+d.pageType,b,"VSEDistributionCards")},ua=function(a,b,e){var g,h;try{if(c["default"].$("."+d.cardId).length){var k=
!1,l=b.map(function(m){return m.contentId}).join(","),f=b.filter(function(m){return""!==m.metadata.rankingStrategy}).map(function(m){return m.metadata.rankingStrategy}).join(","),n=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetRendered",intPayload:1,videoAsinList:l,rankingStrategy:f});A(n);q("cardWidgetRendered",1);var r=function(){c["default"].delay(function(){var m=w.getElementsWhichAreInViewPort();if(m){var p=b.filter(function(M,G){return m.includes(G)});fb(p)}},500)},x=function(){for(var m=
e.carouselItemClassName,p=0;p<b.length;p++)if(!b[p].impressionRecorded){var M=c["default"].$("."+d.cardId+" ."+m+":nth-child("+(p+1)+")");if(c["default"].onScreen(M,0))ta(b,p),b[p].impressionRecorded=!0;else break}},t=function(){if(k)c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,t);else{var m=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetScrolledInView",intPayload:1,videoAsinList:l,rankingStrategy:f}),p=c["default"].$("."+d.cardId+" ."+e.carouselItemClassName).first();p&&
c["default"].onScreen(p,0)&&(A(m),m=c["default"].now()-a,q("cardWidgetScrolledInViewTime",m),E("cardWidgetScrolledInView"),k=!0,x())}};if(d.enableMultipleImpressions){var H=null===(h=null===(g=document.querySelector("."+e.carouselItemClassName))||void 0===g?void 0:g.parentElement)||void 0===h?void 0:h.parentElement;var w=new eb(H,"."+e.carouselItemClassName,function(){var m=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetScrolledInView",intPayload:1,videoAsinList:l,rankingStrategy:f});A(m);
m=c["default"].now()-a;q("cardWidgetScrolledInViewTime",m);E("cardWidgetScrolledInView");r()})}else t(),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,t);c["default"].on("vse:"+d.clientPrefix+":searchform:focus",function(){var m=d.buildCsmPayload({eventName:d.clientPrefix+":serchFormFocus",intPayload:1,videoAsinList:l,rankingStrategy:f});A(m)});e.widgetMetricsHandler(d.enableMultipleImpressions?r:x,function(m){var p=d.buildCsmPayload({eventName:d.clientPrefix+":"+m+":paginationButtonClicked",
intPayload:1});q(m+":paginationButtonClicked",1);A(p)})}}catch(m){v("Error occurred while emitting widget metrics "+m,"ERROR"),q("widgetMetricsEmissionError")}},fb=function(a){for(var b=0;b<a.length;b++)ta(a,b)},ta=function(a,b){a=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailImpression",intPayload:b,videoAsin:a[b].contentId,rankingStrategy:a[b].metadata.rankingStrategy});A(a)},gb=function(a,b){var e=[];a=a.split(",");0<a.length&&a.forEach(function(g){g=g.split(":");1<g.length&&e.push({name:g[0],
assignment:g[1],ignoreForG2S2Key:b})});return e},aa=function(a,b,e,g,h){void 0===h&&(h=3);h--;bb["default"].post(a,{accepts:"*/*",contentType:"application/json;charset=UTF-8",timeout:3E3},b).then(function(k){e(k)}).catch(function(k){0===k.statusCode?v("Request has failed with unknown status code. Payload: "+JSON.stringify(b),"ERROR"):0<h?aa(a,b,e,g,h):g(k)})},hb=function(a,b){a="/gp/mobile/tag/?ref=vse_cards_ingress"+a+b.replace("/?_encoding=UTF8","");aa(a,{},function(){},function(){})},ib=function(a,
b,e,g,h,k){void 0===k&&(k=!0);var l=a.map(function(f){delete f.htmlEl;return f});b||(b=va(a[0],{}));a=[];e.weblabContext&&(a=gb(e.weblabContext,!0));aa(e.nilgiriEndpoint,{requester:d.requester,clientPrefix:d.clientPrefix,page:d.pageType,placement:d.placement,device:d.deviceType,metadata:{id:"vse-video-widget-card-"+d.clientPrefix,celQueryStringParam:e.celQueryStringParam,requestHasVideoData:"true"},videoDataList:k?l:void 0,video:{contentID:b.contentId,contentIDType:"VIDEO_ID",videoURL:b.videoUrl,
imageURL:b.imageUrl,vendorCode:b.vendorCode,vendorTrackingId:b.vendorTrackingId,videoReferenceId:b.videoReferenceId,videoTitle:b.title},marketplaceID:e.marketplaceId,locale:e.locale,product:{contentID:b.productAsin,contentIDType:"ASIN",parentContentID:b.parentAsin,parentContentIDType:"ASIN"},creativeId:d.creativeId,weblabContext:a},g,h)},va=function(a,b){var e=a.productAsin;e||c["default"].objectIsEmpty(a.metadata.relatedProductsAsins)||(e=a.metadata.relatedProductsAsins.split(",")[0]);var g=a.contentId,
h=a.metadata.title,k=a.metadata.vendorName,l=a.metadata.vendorCode,f=a.metadata.entityId,n=a.metadata.entityType,r=a.metadata.fullReviewLink,x=a.metadata.title,t=a.metadata.videoURL,H=a.metadata.formattedDuration,w=a.metadata.videoImageUrl,m=a.parentAsin,p="vse-cards-ingress"+a.index,M=a.metadata.relatedProductsAsins,G=a.metadata.vendorTrackingId,R=a.metadata.referenceId,jb=a.index,F=a.metadata.closedCaptions,wa=[];if(F&&(F=F.split(","),0===F.length%2))for(var S=0;S<F.length;S+=2)void 0!==F[S+1]&&
wa.push({locale:F[S],url:F[S+1]});b={contentId:g,title:h,vendorName:k,vendorCode:l,entityId:f,entityType:n,referenceUrl:r,referenceLinkTitle:x,videoUrl:t,duration:H,imageUrl:w,videoVoteContainer:{},productAsin:e,parentAsin:m,refTag:p,relatedProducts:M,vendorTrackingId:G,videoReferenceId:R,index:jb,$el:b,closedCaptions:wa,videoDetailPageLink:a.metadata.videoDetailPageLink,impressionRecorded:a.impressionRecorded,lastPlayingTimestamp:a.lastPlayingTimestamp,htmlEl:a.htmlEl,rankingStrategy:a.metadata.rankingStrategy,
aciContentId:a.metadata.aciContentId,videoMimeType:a.metadata.videoMimeType,profileLink:a.metadata.profileLink,profileImageUrl:a.metadata.profileImageUrl,source:""===a.metadata.source?"VSE":a.metadata.source};"true"===a.metadata.isSponsoredBrandVideo&&(g={adFeedbackUrl:a.metadata.adFeedbackUrl||"",clickTrackerUrl:a.metadata.clickTrackerUrl||"",instrumentationPixelUrl:a.metadata.instrumentationPixelUrl||"",trackingPixelUrl:a.metadata.trackingPixelUrl||"",linkUrl:a.metadata.linkUrl||""},b=z.__assign(z.__assign({},
b),{sponsoredBrandVideoMetadata:g,isSponsoredBrandVideo:a.metadata.isSponsoredBrandVideo}));return b},ba=function(a,b,e){var g=[];[].forEach.call(a,function(h,k){var l=h.dataset.asin,f=h.dataset;if(l){l={contentId:l,productAsin:f.productAsin||"",parentAsin:f.parentAsin||"",metadata:{videoImageUrl:f.videoImageUrlUnchanged||f.videoImageUrl||"",videoURL:f.videoUrl||f.videoURL||"",title:f.title||"",formattedDuration:f.formattedDuration||"",vendorName:f.vendorName||"",vendorCode:f.vendorCode||"",referenceId:f.referenceId||
"",fullReviewLink:f.referenceUrl||"",videoDetailPageLink:f.videoDetailPageLink||"vdp/"+l+b.celQueryStringParam,asin:f.asin||"",vendorTrackingId:f.vendorTrackingId||"",relatedProductsAsins:f.relatedProductsAsins||"",closedCaptions:f.closedCaptions||"",creatorType:f.creatorType||"",publicName:f.publicName||"",profileLink:f.profileLink||"",profileImageUrl:f.profileImageUrl||"",rankingStrategy:f.rankingStrategy||"",aciContentId:f.csaCItemId||"",videoMimeType:f.videoMimeType||"",entityId:f.entityId||"",
entityType:f.entityType||"",videoImageHeight:f.videoImageHeight||"",videoImageWidth:f.videoImageWidth||"",videoImagePhysicalId:f.videoImagePhysicalId||"",videoImageExtension:f.videoImageExtension||"",groupType:f.groupType||"",source:f.source||""},impressionRecorded:!1,lastPlayingTimestamp:0,index:k,htmlEl:h};"true"===f.isSponsoredBrandVideo&&(h=h.querySelectorAll("."+e.vseSbVideoDataItem)[0])&&(h={adFeedbackUrl:h.dataset.adFeedbackUrl||"",clickTrackerUrl:h.dataset.clickTrackerUrl||"",instrumentationPixelUrl:h.dataset.instrumentationPixelUrl||
"",trackingPixelUrl:h.dataset.trackingPixelUrl||"",linkUrl:h.dataset.linkUrl||"",isSponsoredBrandVideo:f.isSponsoredBrandVideo,videoDetailPageLink:f.vdpUrl||""},l.metadata=z.__assign(z.__assign({},l.metadata),h));g.push(l);k=Q["default"].cardRoot.getElementsByClassName(e.vseVideoDataItem)[k];try{f.profileLink&&f.profileImageUrl&&k&&xa(k,k.querySelector("."+e.vseProfilePlaceholder),e.vseVideoThumbnailProfile)}catch(n){v("Exception has occurred while initializing profiles. Exception details: "+n,"ERROR"),
q("profileInitializationFailure",1)}try{""!==f.disclosureText&&""!==f.disclosureLink&&k&&xa(k,k.querySelector("."+e.vseVideoCreatorContainer),e.vseVideoDisclosure)}catch(n){v("Exception has occurred while moving the disclosure link. Exception details: "+n,"ERROR"),q("moveDisclosureElementFailure",1)}}});return g},xa=function(a,b,e){a=a.querySelector("."+e);b&&a&&a.parentNode&&(b.appendChild(a.cloneNode(!0)),a.parentNode.removeChild(a),(b=b.querySelector("."+e))&&b.classList.remove("aok-hidden"))},
ya=function(a){var b=L["default"].innerHeight*(400<=a.height()?.1:.2),e=L["default"].innerHeight-a.height()-b;return L["default"].scrollY+e>=a.offset().top&&L["default"].scrollY+b<=a.offset().top},U=function(){return L["default"].innerWidth>L["default"].innerHeight},y,V=!1,za,ca,B,u,N,da=!1,ea,T,O,C,I,J,K,W=!1,Aa=!0,Ba=!1,fa,ha=0,X,Ca=null,pb=function(a,b,e,g,h,k,l,f){void 0===h&&(h=!1);void 0===k&&(k=!0);void 0===l&&(l=!1);void 0===f&&(f=void 0);return z.__awaiter(void 0,void 0,void 0,function(){var n,
r,x;return z.__generator(this,function(t){try{N=e;u=b;B=a;W=h;Aa=k;Ba=l;n=c["default"].now();sa={schemaId:"vse.VSECardsEvents.7",producerId:"vsemetrics_widgetcards",requiredNumOfFields:13};J=Q["default"].cardRoot.getElementsByClassName(u.vseVideoDataItem);if(!J)return q("noCardsIngressDom"),P(),[2];0<c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview").length&&(X=c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview"),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,
ia),ia());if((r=Q["default"].cardRoot.getElementsByClassName(u.vseWidgetPageState))&&r[0]&&r[0].dataset){I=r[0].dataset;y=ba(J,I,u);t=I;var H=f,w,m,p;void 0===H&&(H="vse_cards");d.deviceType=B?"Mobile":"Desktop";d.pageType=t.client||"Gateway";d.clientName=null!==(w=t.clientName)&&void 0!==w?w:"";var M="IVE_VFTP"==d.clientName?d.clientName.toLowerCase():d.pageType.toLowerCase();d.clientPrefix=M;d.placement=(""!==d.clientName?d.clientName:d.pageType)+"Card-"+d.deviceType;d.metricsPlacement=(c["default"].capabilities.mobile?
c["default"].capabilities.isAmazonApp?"mobile_app":"mobile_web":c["default"].capabilities.tablet?c["default"].capabilities.isAmazonApp?"tablet_app":"tablet_web":"desktop_web")+"."+d.placement+"."+H;d.cardId=null!==(m=t.cardId)&&void 0!==m?m:"";d.creativeId=null!==(p=t.creativeId)&&void 0!==p?p:"";d.requester=t.requester||"VSEWidgetCards";d.enableMultipleImpressions="T1"===t.enableMultipleImpressions;ea="vse-component-feed-carousel-"+d.cardId;O="vse-widget-popover-"+d.cardId;if(!c["default"].capabilities.video)return q("videoNotSupported"),
[2];E("cardWidgetRendered");var G=y[0].productAsin?y[0].productAsin:"";d.buildCsmPayload=db({placementContext:d.metricsPlacement,clientId:"VSE",eventSource:"VSEWidgetCards",stringPayload:null!==G&&void 0!==G?G:"",creativeId:d.creativeId});if(B||"Detail"===d.pageType)ua(n,y,g);else{c["default"].$("."+d.cardId+" [class*=vsePlaceholder] .a-fixed-right-grid-inner").addClass(u.vseNoRightPadding);w=n;try{Da(w,g,"vse-carousel-items-added-"+ea),Da(w,g,"vse:cards:"+d.clientPrefix+":quad:ready")}catch(R){ja(R)}c["default"].trigger("vse-card-ready-"+
ea)}(x=c["default"].capabilities.isAmazonApp&&c["default"].capabilities.android&&(c["default"].capabilities.androidVersion+"").startsWith("8"))?(q("useMshopAutoplayFallback"),P()):(kb(),lb(),mb(),nb(),ob());"gatewayquad"===d.clientPrefix&&c["default"].trigger("vse:cards:"+d.clientPrefix+":quad:ready");W&&(Ea(null,c["default"].now()),Fa())}else q("pageStateNotFound"),P()}catch(R){v("fatal exception has occurred. Exception details: "+R,"FATAL"),q("widgetFatalException"),P()}return[2]})})},Da=function(a,
b,e){c["default"].off(e);c["default"].on(e,function(){V||(V=!0,y=ba(J,I,u),ua(a,y,b))})},lb=function(a){void 0===a&&(a="click touch");c["default"].declarative("vse-widget-carousel-see-more-"+d.cardId,a,function(){return Ga()});c["default"].declarative("vse-widget-carousel-custom-action-"+d.cardId,a,function(b){var e;(b=null===(e=b.data)||void 0===e?void 0:e.link)?(Ha("widgetCustomActionClicked"),ra["default"].setLocation(b)):Ga()})},Ga=function(){B&&(da=!0);c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").find(".vse-carousel-item").first().click();
Ha("seeMoreLinkClicked")},Ha=function(a){E(a);a=d.buildCsmPayload({eventName:d.clientPrefix+":"+a,intPayload:1});A(a)},mb=function(){var a=0;c["default"].off("a:popover:afterShow:vse-widget-popover-"+d.cardId);c["default"].on("a:popover:afterShow:vse-widget-popover-"+d.cardId,function(b){try{if(c["default"].$(b.popover.$popover).addClass(c["default"].$("#"+O).data("cssClass")),a++,ca=!0,1===a){c["default"].$(b.popover.$popover).addClass(u.vseVerticalLightbox);var e=c["default"].now();C&&C.refresh();
W?(c["default"].$(b.popover.$popover).addClass(u.vseRemoveAbsolute),ka()):(Ea(b.popover.$popover,e),Fa())}else ka()}catch(g){ja(g)}})},Ea=function(a,b){c["default"].on(d.clientPrefix+":vse:player:registered",function(){c["default"].$("#"+O+" [class*=_vseWidgetLbVideoBlock_]").first().animate({opacity:1});if(ca){ka();c["default"].$(a).addClass(u.vseRemoveAbsolute);var e=c["default"].now()-b;E("cardWidgetPopoverContentWaitTime",e)}});c["default"].on("vse:cards:"+d.clientPrefix+":componentbuilder:failed",
function(){Ia();C?C.hide():c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:close");W||c["default"].delay(function(){ra["default"].setLocation(K.videoDetailPageLink)},500)})},ka=function(){da&&c["default"].trigger("vse:"+d.clientPrefix+":page:watchAllClicked");da=!1;var a={assetSpec:K,lightBoxId:""+O};!0===Ba&&Ca!==K.contentId&&(Ca=K.contentId,a.lazyLoadProductAsin=K.productAsin);c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxOpened",a);a=c["default"].$("#"+O+" [class*=_vseWidgetLbVideoBlock_]");
0<a.length&&(T=a.get(0),null!=N&&(qb(T),N.elect(T)))},nb=function(){c["default"].off("a:popover:beforeHide:vse-widget-popover-"+d.cardId);c["default"].on("a:popover:beforeHide:vse-widget-popover-"+d.cardId,function(){ca=!1;za?(c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxClosed"),null!=N&&T&&N.unsubscribe(T)):E("cardWidgetLBClosedBeforeAjax")})},Fa=function(){ib(y,K,I,function(a){za=!0;q("preloadSuccess");c["default"].$("#"+O+" [class*=_vseWidgetLbVideoBlock_]").html(a.responseBody)},
function(a){c["default"].trigger("vse:cards:"+d.clientPrefix+":componentbuilder:failed");E("preloadFailed");q("preloadFailed:"+a.statusCode);v("NilgiriService componentbuilder call has failed.\n        Status code: "+a.statusCode+". Status text: "+a.statusText,"FATAL");P()},Aa)},P=function(){var a=Q["default"].cardRoot.getElementsByClassName(u.vseSeeMoreLink)[0];a&&a.classList&&a.classList.add("aok-hidden")},kb=function(){try{[].forEach.call(J,function(a){a.children[0].removeAttribute("target")}),
Ja(),c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").delegate(".vse-carousel-item","click",function(a){V||(y=ba(J,I,u),V=!0);if(!c["default"].$(a.target).closest("."+u.vseProfilePlaceholder).length){a.preventDefault();var b=c["default"].$(a.currentTarget);a=b.closest("li").index();var e=y[a];e.metadata&&(K=va(e,b),b=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetClicked",intPayload:1,videoAsin:e.contentId,rankingStrategy:e.metadata.rankingStrategy}),E("cardWidgetClicked"),A(b),
hb(a,I.celQueryStringParam),B?c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:open"):(C=$a["default"].get(c["default"].$("."+d.cardId+" #vse-widget-popover-trigger")),c["default"].objectIsEmpty(C)?q("lbNotFoundDesktop"):C.show()))}})}catch(a){ja(a)}},ja=function(a){v("fatal exception has occurred in LB. Exception details: "+a,"FATAL");q("lightboxOpenFatalException");P();Ia();C&&C.hide()},Ia=function(){Ja();[].forEach.call(J,function(a,b){a.children&&a.children[0]&&a.children[0].setAttribute("target",
y[b].metadata.videoDetailPageLink)})},Ja=function(){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").undelegate(".vse-carousel-item","click")},qb=function(a){N.subscribe(a,function(b){},{buffer:0})},ob=function(){c["default"].on(d.clientPrefix+"-leave-pip",function(a){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel .vse-carousel-item")[a.index].click()})},Ka=function(a,b){fa[b]||(a=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailPreviewPlaybackStart",intPayload:b,videoAsin:a}),
void 0!==a&&null!==a&&(A(a),fa[b]=!0))},ia=function(){c["default"].onScreen(c["default"].$(".vse-video-thumbnail-wrapper"),100)&&(c["default"].each(X,function(a){var b=a.getAttribute("data-src");var e=void 0;void 0===e&&(e=1);e=3*(e-1);b=b.split(",")[e];a.src=b;a.addEventListener("ended",rb)}),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,ia),fa=Array(X.length).fill(!1),B||sb(),tb(),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,Y),Y())},sb=function(){c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card",
"mouseenter",function(){la();var a=c["default"].$(this).find("video"),b=c["default"].$(this).find(".vse-video-thumbnail-img");La(b);0<a.length&&(a[0].play(),b=c["default"].$(this).closest("li").index(),Ka(a[0].getAttribute("data-video-asin"),b),ha=0)});c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card","mouseleave",function(){var a=c["default"].$(this).find(".vse-video-thumbnail-img");ma(a);a=c["default"].$(this).find("video");0<a.length&&na(a[0])})},ma=function(a){a&&
0<a.length&&c["default"].fadeIn(a,300,"ease-in")},La=function(a){a&&0<a.length&&c["default"].fadeOut(a,300,"ease-in")},Ma=function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||0!=a.length)return c["default"].$(a).find("video")[0]},Na=function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||0!=a.length)return c["default"].$(a).find(".vse-video-thumbnail-img")},oa=function(a){var b=Ma(a);if(b){var e=Na(a);La(e);b.play();ha=a;Ka(b.getAttribute("data-video-asin"),
a)}},Y=function(){var a=c["default"].$(".vse-video-widget-container");if(0<a.length&&(!U()&&c["default"].onScreen(a)&&ya(a)||U()&&c["default"].onScreen(a))){c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,Y);c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,Oa);a=B?Pa():ha;var b=Ma(a);if(!b||b.paused)la(),oa(a)}},Oa=function(){var a=c["default"].$(".vse-video-widget-container");0!=a.length&&(!ya(a)&&!U()||U()&&!c["default"].onScreen(a))&&(c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,
Y),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,Oa))},la=function(){c["default"].each(X,function(a){if(0!==a.currentTime){var b=c["default"].$(a).closest(".vse-video-thumbnail-wrapper").find(".vse-video-thumbnail-img");ma(b);na(a)}})},na=function(a){setTimeout(function(){a.currentTime=0;a.load()},300)},Pa=function(){var a=0;try{var b=c["default"].$(".vse-video-widget-container"),e=parseInt(b.find("li").css("width").replace("px",""))+8,g=b.find("ol").css("-webkit-transform").split(/[()]/)[1],
h=Math.abs(parseInt(g.split(",")[4]));a=Math.round(h/e)}catch(k){v("Error has occurred while finding the current focussed Element. Exception details: "+k,"ERROR")}return a},rb=function(a){try{var b=a.target.closest("li");na(a.target);var e=c["default"].$(b).index()+1;a=0;try{var g=c["default"].$(".vse-video-widget-container"),h=parseInt(g.find("li").css("width").replace("px","")),k=B?c["default"].$(window).width():c["default"].$(".vse-video-widget-container .a-carousel-viewport").width();a=Math.floor(k/
(h+8))}catch(x){v("Error has occurred while finding the no of Thumbnails on screen. Exception details: "+x,"ERROR")}var l=a;var f=Math.ceil(e/l),n=Math.ceil((e+1)/l),r=Na(e-1);ma(r);f===n&&oa(e)}catch(x){v("Error has occurred while playing the next preview. Exception details: "+x,"ERROR")}},tb=function(){var a=c["default"].$(".vse-cards-carousel-container");cb["default"].getCarousel(a).on("change:pageNumber",function(){la();setTimeout(function(){oa(Pa())},B?100:310)})},pa={relatedProductsCarousel:"_dnNlL_relatedProductsCarousel_3SVcR",
productCarouselTitle:"_dnNlL_productCarouselTitle_1F0cX",product:"_dnNlL_product_2ZpSd",productLeft:"_dnNlL_productLeft_3rs_R",productRight:"_dnNlL_productRight_1sM69",pImgOverlay:"_dnNlL_pImgOverlay_3G-eo",productData:"_dnNlL_productData_N_M3f",productTitle:"_dnNlL_productTitle_2_9S9",productSeeDetailsLink:"_dnNlL_productSeeDetailsLink_mrXQG",originalPrice:"_dnNlL_originalPrice_25DJQ",priceWrapper:"_dnNlL_priceWrapper_2wCms",dealBadgeWrapper:"_dnNlL_dealBadgeWrapper_3VJRb",dealBadge:"_dnNlL_dealBadge_2KVFw",
messagingText:"_dnNlL_messagingText_p3IAH",vseFeedVideoProductCard:"_dnNlL_vseFeedVideoProductCard_3b4qr",vseFeedCarousel:"_dnNlL_vseFeedCarousel_2ylQm",vseFeedCarouselViewport:"_dnNlL_vseFeedCarouselViewport_3gN26",vseFeedCarouselCard:"_dnNlL_vseFeedCarouselCard_1tTFu",vseFeedCarouselControl:"_dnNlL_vseFeedCarouselControl_2fNuy",vseFeedCarouselControlForPFO:"_dnNlL_vseFeedCarouselControlForPFO_1PHGA",vseFeedCarouselControlLeft:"_dnNlL_vseFeedCarouselControlLeft_2j_eC",vseThumbnailPreviewImg:"_dnNlL_vseThumbnailPreviewImg_213fA",
vseFeedCarouselControlRight:"_dnNlL_vseFeedCarouselControlRight_15okx",vseFeedArrowRight:"_dnNlL_vseFeedArrowRight_pPuqT",vseFeedArrowLeft:"_dnNlL_vseFeedArrowLeft_2Afny",vseFeedScrollbar:"_dnNlL_vseFeedScrollbar_32jln",vseFeedScrollbarTrack:"_dnNlL_vseFeedScrollbarTrack_256oe",vseFeedScrollbarThumb:"_dnNlL_vseFeedScrollbarThumb_3-362",vseFeedCarouselScrollbar:"_dnNlL_vseFeedCarouselScrollbar_3UPW1",vseFeedCarouselShelf:"_dnNlL_vseFeedCarouselShelf_3B1GP",vseSeeMoreLink:"_dnNlL_vseSeeMoreLink_1Qy5G",
vseVideoWidgetHeaderBlock:"_dnNlL_vseVideoWidgetHeaderBlock_3G_Dk",vseVideoWidgetHeader:"_dnNlL_vseVideoWidgetHeader_18OpM",vseWidgetPageState:"_dnNlL_vseWidgetPageState_1TeAr",vseVideoWidgetTitleText:"_dnNlL_vseVideoWidgetTitleText_3ANgv",vseVideoWidgetContainer:"_dnNlL_vseVideoWidgetContainer_pxIPy",vseCarouselItem:"_dnNlL_vseCarouselItem_avJZp",vseVideoImageWrapper:"_dnNlL_vseVideoImageWrapper_2yPZQ",vseProfilePlaceholder:"_dnNlL_vseProfilePlaceholder_38kF4",vseVideoThumbnailProfile:"_dnNlL_vseVideoThumbnailProfile_AcsdZ",
thumbnailPreviewWrap:"_dnNlL_thumbnailPreviewWrap_j7GEm",vseWidgetLbVideoBlockWrapper:"_dnNlL_vseWidgetLbVideoBlockWrapper_14mpI",vseWidgetLbAbsolute:"_dnNlL_vseWidgetLbAbsolute_2hEOU",vseVerticalLightbox:"_dnNlL_vseVerticalLightbox_3Qhsb",vseRemoveAbsolute:"_dnNlL_vseRemoveAbsolute_2xbwM",vseVideoDataItem:"_dnNlL_vseVideoDataItem_1KdM9",thumbnailUpdates:"_dnNlL_thumbnailUpdates_2nqyX",videoDurationNoBackground:"_dnNlL_videoDurationNoBackground_pebeP"};qa._operationNames=[];qa.card=function(){return z.__awaiter(void 0,
void 0,void 0,function(){var a,b,e,g,h,k;return z.__generator(this,function(l){switch(l.label){case 0:return a={carouselItemClassName:pa.vseFeedCarouselCard,widgetMetricsHandler:function(f,n){var r=c["default"].throttle(function(){f()},500,{leading:!1});c["default"].on(c["default"].constants.BROWSER_EVENTS.RESIZE,function(){f()});c["default"].$("."+d.cardId+" .vse-feed-carousel-control-left").click(function(){n("left");r()});c["default"].$("."+d.cardId+" .vse-feed-carousel-control-right").click(function(){n("right");
r()})}},e=Q["default"].cardRoot.getElementsByClassName(pa.vseWidgetPageState),g=!0,e&&e[0]&&e[0].dataset&&(b=e[0].dataset,g="false"!==b.shouldUseVideoOrchestrator),g?[4,new Promise(function(f,n){Qa(["@p/gw-video-orchestrator"],function(r){f(Za(r))},n)})]:[3,2];case 1:return k=l.sent(),[3,3];case 2:k=null,l.label=3;case 3:return h=k,[4,pb(!1,pa,h,a)];case 4:return l.sent(),[2]}})})}});
